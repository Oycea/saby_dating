<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Изменение профиля</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Arial', sans-serif;
        }
        .container {
            max-width: 800px;
        }
        .header-logo {
            height: 50px;
        }
        .account-page {
            background-color: #ffffff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease-in-out;
        }
        .account-page:hover {
            transform: scale(1.02);
        }
        .form-header {
            margin-bottom: 20px;
        }
        .form-header h2 {
            color: #007bff;
        }
        .list-group-item {
            font-weight: bold;
            border: none;
            transition: background-color 0.2s;
        }
        .list-group-item:hover {
            background-color: #007bff;
            color: white;
        }
        .list-group-item i {
            margin-right: 10px;
        }
        .form-control {
            border-radius: 30px;
        }
        .btn-primary, .btn-secondary {
            border-radius: 30px;
        }
        .btn-primary {
            background-color: #007bff;
            border: none;
        }
        .btn-primary:hover {
            background-color: #0056b3;
        }
        .btn-secondary {
            background-color: #6c757d;
            border: none;
        }
        .btn-secondary:hover {
            background-color: #5a6268;
        }
    </style>
</head>
<body>
    <header class="bg-primary text-white text-center py-3">
        <img src="logo.png" alt="Логотип сайта" class="header-logo d-inline-block align-middle">
    </header>
    <div class="container mt-5">
        <div class="row">
            <nav class="col-md-3">
                <div class="list-group">
                    <a href="profile.html" class="list-group-item list-group-item-action">
                        <i class="fas fa-user"></i> Аккаунт
                    </a>
                    <a href="dialogs.html" class="list-group-item list-group-item-action">
                        <i class="fas fa-comments"></i> Диалоги
                    </a>
                    <a href="swipes.html" class="list-group-item list-group-item-action">
                        <i class="fas fa-sync-alt"></i> Свайпы
                    </a>
                    <a href="events.html" class="list-group-item list-group-item-action">
                        <i class="fas fa-calendar-alt"></i> Подборки
                    </a>
                </div>
            </nav>
            <main class="col-md-9">
                <div class="account-page">
                    <div class="form-header text-center mb-4">
                        <h2 class="text-primary">Изменение профиля</h2>
                    </div>
                    <form id="edit-profile-form">
                        <div class="form-group">
                            <label for="name">Имя</label>
                            <input type="text" class="form-control" id="name" placeholder="Введите ваше имя">
                        </div>
                        <div class="form-group">
                            <label for="city">Город</label>
                            <input type="text" class="form-control" id="city" placeholder="Введите ваш город">
                        </div>
                        <div class="form-group">
                            <label for="birthday">Дата рождения</label>
                            <input type="date" class="form-control" id="birthday">
                        </div>
                        <div class="form-group">
                            <label for="height">Рост</label>
                            <input type="number" class="form-control" id="height" placeholder="Введите ваш рост">
                        </div>
                        <div class="form-group">
                            <label for="gender_id">Пол</label>
                            <select class="form-control" id="gender_id">
                                <option value="1">Мужской</option>
                                <option value="2">Женский</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="target_id">Цель</label>
                            <input type="number" class="form-control" id="target_id" placeholder="Введите ID цели">
                        </div>
                        <div class="form-group">
                            <label for="communication_id">Вид общения</label>
                            <input type="number" class="form-control" id="communication_id" placeholder="Введите ID связи">
                        </div>
                        <button type="submit" class="btn btn-primary btn-block">Сохранить изменения</button>
                    </form>
                    <div class="text-center mt-3">
                        <a href="profile.html" class="btn btn-secondary">Отмена</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
<script>
    document.getElementById('edit-profile-form').addEventListener('submit', function(event) {
    event.preventDefault(); // Предотвращаем обычное отправление формы

    const name = document.getElementById('name').value || undefined;
    const city = document.getElementById('city').value || undefined;
    const birthday = document.getElementById('birthday').value || undefined;
    const height = document.getElementById('height').value ? parseInt(document.getElementById('height').value) : undefined;
    const gender_id = document.getElementById('gender_id').value ? parseInt(document.getElementById('gender_id').value) : undefined;
    const target_id = document.getElementById('target_id').value ? parseInt(document.getElementById('target_id').value) : undefined;
    const communication_id = document.getElementById('communication_id').value ? parseInt(document.getElementById('communication_id').value) : undefined;

    // Создаем объект с данными для отправки
    const data = {};
    if (name !== undefined) data.name = name;
    if (city !== undefined) data.city = city;
    if (birthday !== undefined) data.birthday = birthday;
    if (height !== undefined) data.height = height;
    if (gender_id !== undefined) data.gender_id = gender_id;
    if (target_id !== undefined) data.target_id = target_id;
    if (communication_id !== undefined) data.communication_id = communication_id;

    // Выполняем запрос на сервер
    fetch('http://195.133.201.168:8000/authorization/update_profile', {
        method: 'PATCH',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${localStorage.getItem('access_token')}` // Если необходимо передать токен
        },
        body: JSON.stringify(data),
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Ошибка при обновлении профиля');
        }
        return response.json();
    })
    .then(updatedUser => {
        alert('Профиль успешно обновлен');
        window.location.href = 'profile.html';
    })
    .catch(error => {
        alert('Не удалось обновить профиль: ' + error.message);
    });
});
</script>
</body>
</html>
